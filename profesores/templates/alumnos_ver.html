{% include 'header.html' %}
{% include 'menu.html' %}
<main>
    <a href="#" class="btn btn-primary btn-sm mb-3">Nuevo Alumno</a>
    <div class="border-top mb-3 w-100"></div>
    <h5 class="text-secondary">Lista de Alumnos</h5>
    <table class="table">
        <thead>
            <tr>
                <th scope="col" class="text-primary p-1">#</th>
                <th scope="col" class="text-primary p-1">Nombres</th>
                <th scope="col" class="text-primary p-1">Apellidos</th>
                <th scope="col" class="text-primary p-1">Email</th>
                <th scope="col" class="text-primary p-1">Colegio</th>
                <th scope="col" class="text-primary p-1">Grado</th>
                <th scope="col" class="text-primary p-1">Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for alumno in alumnos %}
            <tr>
                <td class="p-0 text-secondary">{{ alumno[0] }}</td>
                <td class="p-0 text-secondary">{{ alumno[1] }}</td>
                <td class="p-0 text-secondary">{{ alumno[2] }}</td>
                <td class="p-0 text-secondary">{{ alumno[3] }}</td>
                {% for colegio in colegios %}
                {% if colegio[0] == alumno[4] %}
                <td class="p-0 text-secondary">{{ colegio[1] }}</td>
                {% endif %}
                {% endfor %}
                {% for grado in grados %}
                {% if grado[0] == alumno[5] %}
                <td class="p-0 text-secondary">{{ grado[1] }} {{ grado[2] }}</td>
                {% endif %}
                {% endfor %}
                <td class="p-0 text-secondary"><a href="borrar/{{ alumno[0] }}"><i class="bi bi-trash text-danger"></i></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>    
      </article>
      </div>
      <div class="modal fade" id="modal-info-mensaje" tabindex="-1" role="dialog" aria-labelledby="modal-info-mensaje-title" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title fs-5" id="modal-info-mensaje-title">Mensaje</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              {{ info_mensaje }}
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    {% if info_mensaje %}
    <script>
    $(document).ready(function() {
    $('#modal-info-mensaje').modal('show');
    });
    </script>
    {% endif %}
    <script>
      async function editarProducto(producto_id) {
        try {
          // Enviar la solicitud "GET" al endpoint para editar el producto
          const response = await fetch(`/productos/editar/${producto_id}`, {
            method: "GET",
          });
    
          if (response.ok) {
            // Redireccionar a la página de edición si la respuesta es exitosa
            window.location.href = `/productos/editar/${producto_id}`;
          } else {
            // Manejar errores en la respuesta
            alert("Error al editar el producto");
          }
        } catch (error) {
          // Manejar errores de red u otros errores
          console.error("Error:", error);
          alert("Error al editar el producto");
        }
      }
    </script>
    <script>
      async function eliminarColegio(colegio_id) {
        // Mostrar una ventana emergente para pedir confirmación
        const confirmar = confirm("¿Estás seguro de que deseas eliminar este producto?");
    
        if (confirmar) {
          // Enviar la solicitud "DELETE" si el usuario hace clic en "Aceptar"
          const response = await fetch(`/colegio/borrar/${colegio_id}`, {
            method: "DELETE",
          });
    
          if (response.ok) {
            window.location.href = "/Actualizado";
          } else {
            alert("Error al eliminar el producto");
          }
        } else {
          // Descartar la acción si el usuario hace clic en "Cancelar"
          alert("Acción descartada");
        }
      }
    </script>
</main>
{% include 'footer.html' %}
